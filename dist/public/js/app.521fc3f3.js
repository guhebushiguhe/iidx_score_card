(function(e){function t(t){for(var a,s,o=t[0],l=t[1],c=t[2],p=0,d=[];p<o.length;p++)s=o[p],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&d.push(i[s][0]),i[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(d.length)d.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var l=n[o];0!==i[l]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},i={app:0},r=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"app",attrs:{id:"app"}},[n("div",{staticClass:"title-wrap"},[n("p",{staticClass:"time"},[e._v(e._s((new Date).toLocaleString())),n("span",{domProps:{innerHTML:e._s("&nbsp;&nbsp;&nbsp;&nbsp;")}}),e._v(e._s(e.version))]),n("div",{staticClass:"share-btn",on:{click:e.capture}},[e._v("↗")])]),n("h2",{staticClass:"title"},[e._v("IIDX查分器")]),n("div",{staticClass:"box search-box"},[n("span",[e._v("DJName ")]),n("span",{staticClass:"search-name-wrap"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.djName,expression:"djName"}],ref:"nameInp",staticClass:"searchInp",attrs:{type:"text",disabled:e.isLoading},domProps:{value:e.djName},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getProfiles(t)},focus:function(t){e.isTyping=!0},blur:e.lossTyping,input:function(t){t.target.composing||(e.djName=t.target.value)}}}),e.names.length>0&&e.isTyping?n("ul",{staticClass:"names-ul"},e._l(e.names,(function(t){return n("li",{key:t,staticClass:"names-li"},[n("span",{staticClass:"name",on:{click:function(n){return e.searchName(t)}}},[e._v(e._s(t))]),n("span",{staticClass:"delBtn",on:{click:function(n){return e.delName(t)}}},[e._v("×")])])})),0):e._e()]),n("span",[e._v("lv ")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.lv,expression:"lv"}],staticClass:"searchInp",attrs:{type:"text",disabled:e.isLoading},domProps:{value:e.lv},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getProfiles(t)},input:function(t){t.target.composing||(e.lv=t.target.value)}}}),n("button",{attrs:{type:"button",disabled:e.isLoading},on:{click:e.getProfiles}},[e._v("搜索")]),n("br"),e._l(e.playStyleList,(function(t){return n("span",{key:t.value},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.playStyle,expression:"playStyle"}],staticClass:"radio",attrs:{type:"radio",id:t.value,disabled:e.isLoading},domProps:{value:t.value,checked:e._q(e.playStyle,t.value)},on:{change:function(n){e.playStyle=t.value}}}),e._v(" "+e._s(t.label)+" ")])])}))],2),e.isNameSelectShow?n("div",{staticClass:"box profiles-select"},[n("p",{staticClass:"msg"},[e._v(e._s(e.profiles?"存在重名账号，请选择账号继续":"查无此名，请重新输入"))]),e.profiles?n("div",e._l(e.profiles,(function(t,a){return n("div",{key:a,staticClass:"profile-card",on:{click:function(n){return e.continueGetProfile(t)}}},[n("p",[n("span",[e._v("DJName: "),n("span",{staticClass:"djName"},[e._v(e._s(t.dj_name))])])]),"SINGLE"==e.playStyle||"ALL"==e.playStyle?n("p",[e._v(" SP Rank: "+e._s(t.sp.rank)+", Plays: "+e._s(t.sp.plays)+", DJ Points: "+e._s(t.sp.dj_points)+" ")]):e._e(),"DOUBLE"==e.playStyle||"ALL"==e.playStyle?n("p",[e._v(" DP Rank: "+e._s(t.dp.rank)+", Plays: "+e._s(t.dp.plays)+", DJ Points: "+e._s(t.dp.dj_points)+" ")]):e._e()])})),0):e._e()]):e._e(),e.profile?n("div",{staticClass:"box profiles-box"},[n("p",[n("span",[e._v("DJName: "),n("span",{staticClass:"djName"},[e._v(e._s(e.profile.dj_name))])])]),"SINGLE"==e.playStyle||"ALL"==e.playStyle?n("p",[e._v(" SP Rank: "+e._s(e.profile.sp.rank)+", Plays: "+e._s(e.profile.sp.plays)+", DJ Points: "+e._s(e.profile.sp.dj_points)+" ")]):e._e(),"DOUBLE"==e.playStyle||"ALL"==e.playStyle?n("p",[e._v(" DP Rank: "+e._s(e.profile.dp.rank)+", Plays: "+e._s(e.profile.dp.plays)+", DJ Points: "+e._s(e.profile.dp.dj_points)+" ")]):e._e()]):e._e(),n("div",{staticClass:"box score-box"},[e.isLoading?n("p",{staticClass:"#9ab5c2"},[e._v("加载中，请耐心等候···")]):e._e(),e.scores.length>0&&!e.isLoading?n("ul",e._l(e.scores,(function(t,a){return n("li",{key:t.label,staticClass:"score-li"},[n("span",[e._v(e._s(t.label))]),n("span",{class:e.newScores.length>0?"score":""},[e._v(e._s(t.value))]),e.newScores.length>0?n("span",{staticClass:"plus"},[e._v(e._s(e.parsePlus(e.newScores[a].value)))]):e._e()])})),0):e._e(),e.newTime?n("div",{staticClass:"new-time"},[e._v("最后亿把"),n("br"),e._v(e._s(e.newTime.startTime+" ---- "+e.newTime.endTime))]):e._e()]),e.capURL?n("div",{staticClass:"cap-wrap",on:{click:function(t){e.capURL=null}}},[n("div",{staticClass:"btn-wrap"},[e._v(" 长按图片选择分享图片，任意位置点击取消 ")]),n("div",{ref:"capImg"},[n("img",{staticClass:"cap-img",attrs:{src:e.capURL,alt:""}})])]):e._e()])},r=[],s=n("5530"),o=n("1da1"),l=n("2909"),c=(n("96cf"),n("a15b"),n("4de4"),n("1276"),n("ac1f"),n("5319"),n("caad"),n("2532"),n("d81d"),n("b680"),n("b64b"),n("c0e9")),u=n.n(c),p=(n("f969"),n("b311"),{name:"App",components:{},data:function(){return{version:"v1.02",names:[],isTyping:!1,capURL:null,newTime:null,djName:"",lv:"ALL",playStyle:"ALL",isLoading:!1,isNameSelectShow:!1,profiles:null,profile:null,qpros:{_id:"XXXX",_etag:"XXXX",head:"XXXX",hair:"XXXX",hand:"XXXX",face:"XXXX",body:"XXXX"},scores:[],newScores:[],profilesData:{},scoresData:{},newScoresData:{},idsList:{},playStyleList:[{label:"ALL",value:"ALL"},{label:"SP",value:"SINGLE"},{label:"DP",value:"DOUBLE"}],gradeList:[{grade:"MAX",min:1,max:2},{grade:"MAX-",min:.9445,max:1},{grade:"AAA",min:.8888,max:.9445},{grade:"AA",min:.7777,max:.8888},{grade:"A",min:.6666,max:.7777},{grade:"B",min:.5555,max:.6666},{grade:"C",min:.4444,max:.5555},{grade:"D",min:.3333,max:.4444},{grade:"E",min:.2222,max:.3333},{grade:"F",min:0,max:.2222}],lampList:["FULL_COMBO","EX_HARD_CLEAR","HARD_CLEAR","CLEAR","ASSIST_CLEAR","EASY_CLEAR","FAILED"]}},computed:{labelList:function(){var e=this.lv;return{ALL_TEMP:"lv.".concat(e||"ALL"),FULL_COMBO:"FC",EX_HARD_CLEAR:"EXHC",HARD_CLEAR:"HC",CLEAR:"NC",ASSIST_CLEAR:"AC",EASY_CLEAR:"EC",FAILED:"Failed",clearRate:"CLEAR RATE",MAX:"MAX","MAX-":"MAX-",AAA:"AAA",AA:"AA",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F"}}},methods:{capture:function(){var e=this,t=this.$refs.app;u()(t,{backgroundColor:"#333536",useCORS:!0}).then((function(t){var n=t.toDataURL("".concat(e.id||null,"_scores/jpg"));e.capURL=n}))},lossTyping:function(){var e=this;setTimeout((function(){e.isTyping=!1}),300)},searchName:function(e){this.djName=e,this.getProfiles()},addName:function(e){this.names.push(e),this.setCookie("names",this.names.join("|"))},delName:function(e){var t=Object(l["a"])(this.names);this.names=t.filter((function(t){return t!=e})),this.setCookie("names",this.names.join("|"))},getNames:function(){var e=this.getCookie("names");e&&(this.names=e.split("|"))},setCookie:function(e,t,n){n=n||0;var a="";if(0!=n){var i=new Date;i.setTime(i.getTime()+1e3*n),a="; expires="+i.toGMTString()}document.cookie=e+"="+escape(t)+a+"; path=/"},getCookie:function(e){if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!=t){t=t+e.length+1;var n=document.cookie.indexOf(";",t);return-1==n&&(n=document.cookie.length),unescape(document.cookie.substring(t,n)).replace(/\"/g,"")}}return null},getProfiles:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,a,i,r,s,o,l,c,u,p,d,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isNameSelectShow=!1,e.newTime=null,n=e.names,a=e.djName,""!=a){t.next=7;break}return alert("请输入DJ NAME"),t.abrupt("return");case 7:if(i=e.lv,e.lv=""==i?"ALL":i,r=e.idsList,s=r[a]||null,o=e.scoresData,l=e.newScoresData,!r[a]){t.next=22;break}return c=e.profilesData[s],e.getSingleProfile(c),e.scores=e.parseScores(o[s]),u=l[s],e.newScores=u._items.length>0?e.parseScores(u):[],e.newTime=u.newTime,e.$forceUpdate(),t.abrupt("return");case 22:return n.includes(a)||e.addName(a),e.profile=null,e.scores=[],e.isLoading=!0,t.next=28,e.$axios.getProfiles(a);case 28:if(p=t.sent,d=0,!(p._items.length<=0)){t.next=36;break}return e.isNameSelectShow=!0,e.isLoading=!1,e.profiles=null,e.$refs.nameInp.focus(),t.abrupt("return");case 36:if(!(p._items.length>1)){t.next=42;break}return e.isNameSelectShow=!0,e.isLoading=!1,p._items.sort((function(e,t){var n=new Date(e.access_time).getTime(),a=new Date(t.access_time).getTime();return a-n})),e.profiles=p._items,t.abrupt("return");case 42:f=p["_items"][d],e.getSingleProfile(f),e.getScores();case 45:case"end":return t.stop()}}),t)})))()},getSingleProfile:function(e){this.isNameSelectShow=!1,this.profiles=null,this.profilesData[e._id]=e;var t=e.dj_name,n=e.iidx_id,a=e.sp,i=e.dp,r=e._id,s=e.access_time;this.idsList[t]=r,this.profile={dj_name:t,iidx_id:n,access_time:s,sp:{rank:a.rank,plays:a.plays,dj_points:a.dj_points},dp:{rank:i.rank,plays:i.plays,dj_points:i.dj_points}},this.$forceUpdate()},getScores:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,a,i,r,s,o,c,u,p,d,f,m,v,g,_,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.isLoading=!0,n=e.idsList[e.djName]||null,a=null,i=null,r={_items:[],_links:{},_related:{charts:[],music:[],profiles:[]}};case 5:return t.next=7,e.$axios.getScores(n,i);case 7:p=t.sent,d=p._items,f=p._links,m=p._related,v=m.charts,g=m.music,_=m.profiles,(s=r._items).push.apply(s,Object(l["a"])(d)),(o=r._related.charts).push.apply(o,Object(l["a"])(v)),(c=r._related.music).push.apply(c,Object(l["a"])(g)),(u=r._related.profiles).push.apply(u,Object(l["a"])(_)),a=f._next,i=p._items[249]?p._items[249]._id:null;case 16:if(a){t.next=5;break}case 17:e.isLoading=!1,r._items.map((function(e){var t=r._related.charts.filter((function(t){return t._id==e.chart_id}))[0],n=t.notes;t.play_style;e.grade=e.ex_score/n/2})),e.scoresData[n]=r,e.scores=e.parseScores(r),h=e.newFilter(r),e.newScoresData[n]=h,e.newScores=h._items.length>0?e.parseScores(h):[];case 24:case"end":return t.stop()}}),t)})))()},newFilter:function(e){var t=e._items,n=e._related,a=108e5,i=t.sort((function(e,t){var n=new Date(e.timestamp).getTime(),a=new Date(t.timestamp).getTime();return a-n})),r=new Date(i[0].timestamp).toLocaleString(),s=0;i.some((function(e,t){function n(e){return new Date(e.timestamp).getTime()}if(n(e)-n(i[t+1])>a)return s=new Date(e.timestamp).setHours(5,0,0),!0})),i=i.filter((function(e){return new Date(e.timestamp).getTime()>s}));var o=new Date(i[i.length-1].timestamp).toLocaleString(),l={startTime:o,endTime:r};this.newTime=l;var c={_items:i,_related:n,newTime:l};return c},parseScores:function(e){var t=this.gradeList,n=this.labelList,a=e._items,i=e._related,r=this.lv,o=[],l=["1","2","3","4","5","6","7","8","9","10","11","12"],c=this.playStyle;if(o="ALL"!=c?i.charts.filter((function(e){return e.play_style==c})).map((function(e){var t=e._id,n=e.rating,a=e.play_style;return{_id:t,rating:n,play_style:a}})):i.charts,r&&"ALL"!=r){if(!l.includes(r))return alert("lv不合法，请重新输入"),this.$$nextTick((function(){})),void(this.lv="ALL");o=o.filter((function(e){var t=e.rating;return t==r})).map((function(e){return e._id}))}else o=o.map((function(e){return e._id}));var u=a.filter((function(e){return o.includes(e["chart_id"])})),p={};this.lampList.map((function(e){p[e]=u.filter((function(t){return t.lamp==e})).length}));var d=p.FAILED,f=u.filter((function(e){return"NO_PLAY"==e.status})).length,m=u.length,v=m<=0?"----":((m-d-f)/m*100).toFixed(2)+"%",g=Object(s["a"])(Object(s["a"])({ALL_TEMP:m},p),{},{clearRate:v});t.map((function(e){g[e.grade]=u.filter((function(t){return t.grade>=e.min&&t.grade<e.max})).length}));var _=[];return Object.keys(n).map((function(e){_.push({label:n[e],value:g[e]})})),_},continueGetProfile:function(e){this.getSingleProfile(e),this.getScores()},parsePlus:function(e){return isNaN(e-0)||0==e?"":"↑+"+e}},watch:{djName:function(e,t){e!=t&&(this.djName=e.toUpperCase())},playStyle:function(e,t){e!=t&&""!=this.djName&&this.getProfiles()}},mounted:function(){this.$refs.nameInp.focus(),this.getNames()}}),d=p,f=(n("5c0b"),n("2877")),m=Object(f["a"])(d,i,r,!1,null,null,null),v=m.exports,g=(n("d3b7"),n("bc3a")),_=n.n(g);_.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",_.a.defaults.headers.authorization="Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJ0b2tlbiIsImlhdCI6MTYxMTU5NTY3MSwic3ViIjoiNjQyMDQ2MjYxQHFxLmNvbSIsInNjb3BlIjoibWFjaGluZV9hY2Nlc3Mgcml2YWxfd3JpdGUgc2V0dGluZ3NfcmVhZCBzZXR0aW5nc193cml0ZSJ9.stRjxVQB_-0nkJnJf4o2ZNGyQGUmOI4RddUKC5BEKZ4",_.a.defaults.baseURL="https://arcana.nu",_.a.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject(e)})),_.a.interceptors.response.use((function(e){return e.data}),(function(e){return console.log(e),Promise.reject(e)}));var h=_.a;function y(e){return h.get("/api/v1/iidx/27/profiles/",{params:{dj_name:e}})}function b(e,t){return h.get("/api/v1/iidx/27/player_bests/",{params:t?{profile_id:e,__pos:t}:{profile_id:e}})}var L={getProfiles:y,getScores:b};a["a"].config.productionTip=!1,a["a"].prototype.$axios=L,new a["a"]({render:function(e){return e(v)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";n("9c0c")},"9c0c":function(e,t,n){},f969:function(e,t,n){n("5319"),n("ac1f"),n("466d"),n("99af"),function(e){Canvas2Image=function(){var e=function(){var e=document.createElement("canvas"),t=e.getContext("2d");return{canvas:!!t,imageData:!!t.getImageData,dataURL:!!e.toDataURL,btoa:!!window.btoa}}(),t="image/octet-stream";function n(e,t,n){var a=e.width,i=e.height;void 0==t&&(t=a),void 0==n&&(n=i);var r=document.createElement("canvas"),s=r.getContext("2d");return r.width=t,r.height=n,s.drawImage(e,0,0,a,i,0,0,t,n),r}function a(e,t,a,i){return e=n(e,a,i),e.toDataURL(t)}function i(e){document.location.href=e}function r(e){var t=document.createElement("img");return t.src=e,t}function s(e){e=e.toLowerCase().replace(/jpg/i,"jpeg");var t=e.match(/png|jpeg|bmp|gif/)[0];return"image/"+t}function o(e){if(!window.btoa)throw"btoa undefined";var t="";if("string"==typeof e)t=e;else for(var n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function l(e){var t=e.width,n=e.height;return e.getContext("2d").getImageData(0,0,t,n)}function c(e,t){return"data:"+t+";base64,"+e}var u=function(e){var t=e.width,n=e.height,a=t*n*3,i=a+54,r=[66,77,255&i,i>>8&255,i>>16&255,i>>24&255,0,0,0,0,54,0,0,0],s=[40,0,0,0,255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,1,0,24,0,0,0,0,0,255&a,a>>8&255,a>>16&255,a>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=(4-3*t%4)%4,c=e.data,u="",p=t<<2,d=n,f=String.fromCharCode;do{for(var m=p*(d-1),v="",g=0;g<t;g++){var _=g<<2;v+=f(c[m+_+2])+f(c[m+_+1])+f(c[m+_])}for(var h=0;h<l;h++)v+=String.fromCharCode(0);u+=v}while(--d);var y=o(r.concat(s))+o(u);return y},p=function(r,o,p,d){if(e.canvas&&e.dataURL)if("string"==typeof r&&(r=document.getElementById(r)),void 0==d&&(d="png"),d=s(d),/bmp/.test(d)){var f=l(n(r,o,p)),m=u(f);i(c(m,t))}else{m=a(r,d,o,p);i(m.replace(d,t))}},d=function(t,i,o,p){if(e.canvas&&e.dataURL){if("string"==typeof t&&(t=document.getElementById(t)),void 0==p&&(p="png"),p=s(p),/bmp/.test(p)){var d=l(n(t,i,o)),f=u(d);return r(c(f,"image/bmp"))}f=a(t,p,i,o);return r(f)}};return{saveAsImage:p,saveAsPNG:function(e,t,n){return p(e,t,n,"png")},saveAsJPEG:function(e,t,n){return p(e,t,n,"jpeg")},saveAsGIF:function(e,t,n){return p(e,t,n,"gif")},saveAsBMP:function(e,t,n){return p(e,t,n,"bmp")},convertToImage:d,convertToPNG:function(e,t,n){return d(e,t,n,"png")},convertToJPEG:function(e,t,n){return d(e,t,n,"jpeg")},convertToGIF:function(e,t,n){return d(e,t,n,"gif")},convertToBMP:function(e,t,n){return d(e,t,n,"bmp")}}}()}()}});
//# sourceMappingURL=app.521fc3f3.js.map